(()=>{document.location.href;const e=hotel_settings?.url_page_search;let t=JSON.parse(window.localStorage.getItem("wphb_filter_rooms"))||{},r=!0;const o=document.querySelector(".hotel-booking-search"),n=(e,t)=>{const r=new URL(e);return Object.keys(t).forEach((e=>{r.searchParams.set(e,t[e])})),r},a=()=>{const e=document.querySelector(".wp-hotel-booking-search-rooms .hotel-booking-search form#hb-form-search-page");null!==e&&c(e,t)},c=(e,t,o=!1)=>{const a=document.querySelector(".wp-hotel-booking-search-rooms .hotel-booking-search ul.wphb-skeleton-animation"),c=document.querySelector(".wp-hotel-booking-search-rooms .hotel-booking-search .detail__booking-rooms"),h=document.querySelector(".wp-hotel-booking-search-rooms .sort-by-wrapper .show-number"),m=hotel_settings.wphb_rest_url;if(!m)return;if(0===Object.keys(t).length){const e=new Intl.DateTimeFormat("en-US",{month:"long"}).format,r=new Date,o=e(r)+" "+("0"+r.getDate()).slice(-2)+", "+r.getFullYear(),n=new Date((new Date).getTime()+864e5),a=e(n)+" "+("0"+n.getDate()).slice(-2)+", "+n.getFullYear();t.check_in_date=o,t.check_out_date=a,t.adults=null,t.max_child=null,t.paged=1;const c=document.querySelector("#hotel-booking-search-filter");if(c){const e=c.querySelector(".hb-price-field"),r=c.querySelector(".hb-rating-field"),o=c.querySelector(".hb-type-field");e&&(t.min_price="",t.max_price=""),r&&(t.rating=""),o&&(t.room_type="")}}const p=n(m+"wphb/v1/rooms/search-rooms",{...t});wp.apiFetch({path:"wphb/v1/rooms/search-rooms"+p.search,method:"GET"}).then((t=>{o&&o.classList.remove("wphb_loading");const{status:n,data:i,message:u}=t;r&&l(e,a,c);const m=document.querySelector(".rooms-pagination");if(m&&m.remove(),"error"===n)throw new Error(u||"Error");c.style.display="block",c.innerHTML=i.content,h&&(h.innerHTML=i.show_number);const p=i.pagination;if(void 0!==p){const t=(new DOMParser).parseFromString(p,"text/html").querySelector(".rooms-pagination");t&&(c.after(t),s(e,a,c))}})).catch((e=>{c.innerHTML="";const t=document.querySelector(".wphb-message.error");t?t.innerHTML=e.message||"Error: Query wphb/v1/rooms/search-room":c.insertAdjacentHTML("beforeend",`<p class="wphb-message error" style="display:block">${e.message||"Error: Query wphb/v1/rooms/search-room"}</p>`),h&&(h.innerHTML="")})).finally((()=>{a.style.display="none",window.localStorage.setItem("wphb_filter_rooms",JSON.stringify(t));let o=n(document.location,t);o=((e,t)=>(["min_price","max_price","rating","room_type"].map((r=>{t.hasOwnProperty(r)||e.searchParams.delete(r)})),e))(o,t);const c=o.href;if("select-room-extra"!=new URL(c).searchParams.get("is_page_room_extra")&&!r){window.history.pushState("","",o);const e=document.querySelector('.wp-hotel-booking-search-rooms .hotel-booking-search form#hb-form-search-page input[name="check_in_date"]'),r=document.querySelector('.wp-hotel-booking-search-rooms .hotel-booking-search form#hb-form-search-page input[name="check_out_date"]');e.value=t.check_in_date,r.value=t.check_out_date}i(e),r=!1;const l=document.querySelector(".wp-hotel-booking-search-rooms .hotel-booking-search");null!=l&&l.scrollIntoView({behavior:"smooth"}),u()}))},l=(e,r,o)=>{null!==e&&e.addEventListener("submit",(n=>{n.preventDefault();const a=e.querySelector('input[name="check_in_date"]').value,l=e.querySelector('input[name="check_out_date"]').value,s=e.querySelector('select[name="adults_capacity"]')?e.querySelector('select[name="adults_capacity"]').value:0,i=e.querySelector('select[name="max_child"]')?e.querySelector('select[name="max_child"]').value:0,u=e.querySelector('input[name="paged"]')?e.querySelector('input[name="paged"]').value:1,h=e.querySelector("button.wphb-button");if(h&&h.classList.add("wphb_loading"),""===a||""===l)return alert(" Please select check in and check out date and search again! "),void(h&&h.classList.remove("wphb_loading"));o.innerHTML="",r.style.display="block",t={...t,check_in_date:a,check_out_date:l,adults:s,max_child:i,paged:u},window.localStorage.setItem("wphb_filter_rooms",JSON.stringify(t)),c(e,t,h)}))},s=(e,t,r)=>{const o=document.querySelectorAll(".wp-hotel-booking-search-rooms .rooms-pagination .page-numbers");o.length>0&&o.forEach((n=>n.addEventListener("click",(a=>{a.preventDefault(),a.stopPropagation(),r.style.display="none",t.style.display="block";let l=JSON.parse(window.localStorage.getItem("wphb_filter_rooms"))||{};if(a.currentTarget.getAttribute("href")){const t=[...o].filter((e=>e.classList.contains("current"))),r=parseInt(a.currentTarget.textContent)||n.classList.contains("next")&&parseInt(t[0].textContent)+1||n.classList.contains("prev")&&parseInt(t[0].textContent)-1;l.paged=r,c(e,{...l})}}))))},i=e=>{const t=document.querySelectorAll(".wp-hotel-booking-search-rooms form.hb-page-search-room-results");if(0==t.length)return;const r=e.querySelector('input[name="check_in_date"]')?.value,o=e.querySelector('input[name="check_out_date"]')?.value;t.forEach((function(e){e.addEventListener("submit",(function(t){t.preventDefault();const n=e.querySelector('select[name="hb-num-of-rooms"]')?.value,a=e.querySelector('input[name="room-id"]')?.value,c=e.querySelector('select[name="hb-num-of-rooms"]')?.value;if(0==c)return void alert("Please select quantity room!");if(""===r||""===o)return void alert(" Please select check in and check out date and search again! ");const l=e.querySelector("button.hb_add_to_cart");l&&l.classList.add("wphb_loading"),(async(e,t=!1,n,a)=>{const c=[],l=e.querySelectorAll("input.hb_optional_quantity_selected");l&&l.forEach((e=>{if(e.checked){const t=e.dataset.id,r=parseInt(e.parentElement?.nextElementSibling?.querySelector('input[class="hb_optional_quantity"]')?.value)||1;t&&c.push({extraID:t,qty:r})}}));try{const e=await wp.apiFetch({path:"wphb/v1/rooms/book-rooms",method:"POST",data:{roomID:a,checkinDate:r,checkoutDate:o,numRoom:n,extraData:c}}),{status:l,data:s}=e,i=s?.results?.redirect||"";t&&t.classList.remove("wphb_loading"),"success"===l&&i&&(window.location.href=i)}catch(e){alert(e.message&&e.message)}})(e,l,n,a)}))}))},u=()=>{const e=document.querySelector(".hb-page-search-room-results select.number_room_select");null!=e&&e.addEventListener("change",(function(t){t.preventDefault();const r=document.querySelectorAll(".hb-page-search-room-results .hb_optional_quantity");null!=r&&r.forEach((function(t){t.value=e.value}))}))},h=e=>{const t=hotel_settings.currency_symbol||"",r=hotel_settings.currency_position||"left";switch(e=m(e),r){case"left":e=t+e;break;case"right":e+=t;break;case"left_with_space":e=t+" "+e;break;case"right_with_space":e=e+" "+t}return e},m=e=>{const t=hotel_settings.number_decimal||0,r=hotel_settings.thousands_separator||"";return(e=(e/1).toFixed(t)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,r)};document.addEventListener("DOMContentLoaded",(()=>{a(),(()=>{const e=document.querySelector("form.hb-select-extra-results");null!==e&&e.addEventListener("submit",(function(t){t.preventDefault();const r=e.querySelector('button[type="submit"]');r&&r.classList.add("wphb_loading"),(async()=>{const t=[],r=e.querySelector('input[name="cart_id"]').value,o=e.querySelectorAll("input.hb_optional_quantity_selected");o&&o.forEach((e=>{if(e.checked){const r=e?.dataset.id||null,o=parseInt(e.parentElement?.nextElementSibling?.querySelector('input[class="hb_optional_quantity"]')?.value)||1;r&&t.push({extraID:r,qty:o})}}));try{const e=await wp.apiFetch({path:"wphb/v1/rooms/add-extra-cart",method:"POST",data:{cartID:r,extraData:t}}),{status:o,redirect:n}=e;console.log(e),"success"===o&&n&&(window.location.href=n)}catch(e){alert(e.message&&e.message)}})()}))})(),(()=>{if(hotel_settings?.is_page_search){const e=document.querySelector(".thim-widget-search-room");if(null!=e){const t=e.querySelector("form#hb-form-search-page");null!=t&&t.removeAttribute("id");const r=e.querySelector("#hotel-booking-results");null!=r&&r.remove()}}const t=document.querySelectorAll('form[class^="hb-search-form"]:not(#hb-form-search-page)');t.length>0&&t.forEach((t=>{t.addEventListener("submit",(function(r){r.preventDefault();const o=t.querySelector('input[name="check_in_date"]').value,a=t.querySelector('input[name="check_out_date"]').value,c=t.querySelector('select[name="adults_capacity"]')?t.querySelector('select[name="adults_capacity"]').value:0,l=t.querySelector('select[name="max_child"]')?t.querySelector('select[name="max_child"]').value:0,s=t.querySelector('input[name="paged"]')?t.querySelector('input[name="paged"]').value:1;if(""===o||""===a)return void alert(" Please select check in and check out date and search again! ");const i={check_in_date:o,check_out_date:a,adults:c,max_child:l,paged:s};window.localStorage.setItem("wphb_filter_rooms",JSON.stringify(i));const u=n(document.location,i).search;window.location.href=e+u}))}))})(),(()=>{const e=document.getElementById("hb-cart-form");if(null===e)return;const t=e.querySelector("a.hb_checkout");null!==t&&t.addEventListener("click",(function(e){e.preventDefault(),hotel_settings?.checkout_page_url?window.location.href=hotel_settings.checkout_page_url:alert("Please set checkout page url in settings")}))})(),o&&hotel_settings&&hotel_settings.is_page_search&&((()=>{const e=document.querySelectorAll(".hb-price-field");if(e)for(let r=0;r<e.length;r++){const o=e[r],n=o.getAttribute("data-min"),c=o.getAttribute("data-max");let l=o.getAttribute("data-step");if(""===n||""===c||""===l)continue;const s=o.querySelector(".hb-min-price"),i=o.querySelector(".hb-max-price"),u=o.querySelector(".hb-price-range"),m=t.min_price||n,p=t.max_price||c;l=parseInt(l),noUiSlider.create(u,{start:[parseInt(m),parseInt(p)],connect:!0,step:l,tooltips:!1,range:{min:parseInt(n),max:parseInt(c)}}),u.noUiSlider.on("update",(function(e,t,r){s.value=parseInt(e[0]),i.value=parseInt(e[1]),o.querySelector(".min").innerHTML=h(e[0]),o.querySelector(".max").innerHTML=h(e[1])})),o.querySelector("button.apply").addEventListener("click",(function(e){e.preventDefault();const r=s.value,o=i.value;t={...t,min_price:parseInt(r),max_price:parseInt(o)},window.localStorage.setItem("wphb_filter_rooms",JSON.stringify(t)),a()}))}})(),(()=>{const e=document.querySelectorAll(".hb-rating-field");if(e)for(let r=0;r<e.length;r++){const o=e[r],n=o.querySelectorAll('input[type="checkbox"]');[...t.rating||[]].map((e=>{o.querySelector(`input[name ="rating"][value ="${e}"]`).checked=!0}));for(let e=0;e<n.length;e++)n[e].addEventListener("change",(function(e){const r=o.querySelectorAll('input[type="checkbox"]:checked');let n=[];[...r].map((e=>{n.push(e.value)})),t={...t,rating:n},window.localStorage.setItem("wphb_filter_rooms",JSON.stringify(t)),a()}))}})(),(()=>{const e=document.querySelectorAll(".hb-type-field");if(e)for(let r=0;r<e.length;r++){const o=e[r],n=o.querySelectorAll('input[type="checkbox"]');[...t.room_type||[]].map((e=>{o.querySelector(`input[name ="room_type"][value ="${e}"]`).checked=!0}));for(let e=0;e<n.length;e++)n[e].addEventListener("change",(function(e){const r=o.querySelectorAll('input[type="checkbox"]:checked');let n=[];[...r].map((e=>{n.push(e.value)})),t={...t,room_type:n},window.localStorage.setItem("wphb_filter_rooms",JSON.stringify(t)),a()}))}})(),(()=>{const e=document.querySelectorAll(".search-filter-form");if(e)for(let r=0;r<e.length;r++){const o=e[r];o.querySelector(".clear-filter button").addEventListener("click",(function(e){const r=document.querySelector(".hb-price-field");if(r){const e=r.getAttribute("data-min"),t=r.getAttribute("data-max");r.querySelector(".hb-price-range").noUiSlider.updateOptions({start:[parseInt(e),parseInt(t)]})}[...o.querySelectorAll(".hb-rating-field input")].map((e=>{e.checked=!1})),[...o.querySelectorAll(".hb-type-field input")].map((e=>{e.checked=!1})),t.hasOwnProperty("min_price")&&delete t.min_price,t.hasOwnProperty("max_price")&&delete t.max_price,t.hasOwnProperty("rating")&&delete t.rating,t.hasOwnProperty("room_type")&&delete t.room_type,window.localStorage.setItem("wphb_filter_rooms",JSON.stringify(t)),a()}))}})(),(()=>{const e=document.querySelector(".sort-by-wrapper");if(!e)return;const r=t.sort_by||"",o=e.querySelectorAll("ul li"),n=e.querySelector(".toggle");[...o].map((e=>{e.getAttribute("data-value")===r?(n.innerHTML=e.innerHTML,e.classList.add("active")):e.classList.remove("active"),e.addEventListener("click",(function(r){const o=e.getAttribute("data-value");t={...t,sort_by:o},window.localStorage.setItem("wphb_filter_rooms",JSON.stringify(t)),a()}))}))})())}))})();