(()=>{document.location.href;const e=hotel_settings?.url_page_search;let t=JSON.parse(window.localStorage.getItem("wphb_filter_rooms"))||{},o=!0;const r=document.querySelector(".hotel-booking-search"),n=(e,t)=>{const o=new URL(e);return Object.keys(t).forEach((e=>{o.searchParams.set(e,t[e])})),o},a=()=>{const e=document.querySelector(".wp-hotel-booking-search-rooms .hotel-booking-search form#hb-form-search-page");null!==e&&c(e,t)},c=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=document.querySelector(".wp-hotel-booking-search-rooms .hotel-booking-search ul.wphb-skeleton-animation"),c=document.querySelector(".wp-hotel-booking-search-rooms .hotel-booking-search .detail__booking-rooms"),h=document.querySelector(".wp-hotel-booking-search-rooms .sort-by-wrapper .show-number"),m=hotel_settings.wphb_rest_url;if(!m)return;if(0===Object.keys(t).length){const e=new Intl.DateTimeFormat("en-US",{month:"long"}).format,o=new Date,r=e(o)+" "+("0"+o.getDate()).slice(-2)+", "+o.getFullYear(),n=new Date((new Date).getTime()+864e5),a=e(n)+" "+("0"+n.getDate()).slice(-2)+", "+n.getFullYear();t.check_in_date=r,t.check_out_date=a,t.adults=null,t.max_child=null,t.paged=1;const c=document.querySelector("#hotel-booking-search-filter");if(c){const e=c.querySelector(".hb-price-field"),o=c.querySelector(".hb-rating-field"),r=c.querySelector(".hb-type-field");e&&(t.min_price="",t.max_price=""),o&&(t.rating=""),r&&(t.room_type="")}}const p=n(m+"wphb/v1/rooms/search-rooms",{...t});wp.apiFetch({path:"wphb/v1/rooms/search-rooms"+p.search,method:"GET"}).then((t=>{r&&r.classList.remove("wphb_loading");const{status:n,data:i,message:u}=t;o&&l(e,a,c);const m=document.querySelector(".rooms-pagination");if(m&&m.remove(),"error"===n)throw new Error(u||"Error");c.style.display="block",c.innerHTML=i.content,h&&(h.innerHTML=i.show_number);const p=i.pagination;if(void 0!==p){const t=(new DOMParser).parseFromString(p,"text/html").querySelector(".rooms-pagination");t&&(c.after(t),s(e,a,c))}})).catch((e=>{c.innerHTML="";const t=document.querySelector(".wphb-message.error");t?t.innerHTML=e.message||"Error: Query wphb/v1/rooms/search-room":c.insertAdjacentHTML("beforeend",`<p class="wphb-message error" style="display:block">${e.message||"Error: Query wphb/v1/rooms/search-room"}</p>`),h&&(h.innerHTML="")})).finally((()=>{a.style.display="none",window.localStorage.setItem("wphb_filter_rooms",JSON.stringify(t));let r=n(document.location,t);r=((e,t)=>(["min_price","max_price","rating","room_type"].map((o=>{t.hasOwnProperty(o)||e.searchParams.delete(o)})),e))(r,t);const c=r.href;if("select-room-extra"!=new URL(c).searchParams.get("is_page_room_extra")&&!o){window.history.pushState("","",r);const e=document.querySelector('.wp-hotel-booking-search-rooms .hotel-booking-search form#hb-form-search-page input[name="check_in_date"]'),o=document.querySelector('.wp-hotel-booking-search-rooms .hotel-booking-search form#hb-form-search-page input[name="check_out_date"]');e.value=t.check_in_date,o.value=t.check_out_date}i(e),o=!1;const l=document.querySelector(".wp-hotel-booking-search-rooms .hotel-booking-search");null!=l&&l.scrollIntoView({behavior:"smooth"}),u()}))},l=(e,o,r)=>{null!==e&&e.addEventListener("submit",(n=>{n.preventDefault();const a=e.querySelector('input[name="check_in_date"]').value,l=e.querySelector('input[name="check_out_date"]').value,s=e.querySelector('select[name="adults_capacity"]')?e.querySelector('select[name="adults_capacity"]').value:0,i=e.querySelector('select[name="max_child"]')?e.querySelector('select[name="max_child"]').value:0,u=e.querySelector('input[name="paged"]')?e.querySelector('input[name="paged"]').value:1,h=e.querySelector("button.wphb-button");if(h&&h.classList.add("wphb_loading"),""===a||""===l)return alert(" Please select check in and check out date and search again! "),void(h&&h.classList.remove("wphb_loading"));r.innerHTML="",o.style.display="block",t={...t,check_in_date:a,check_out_date:l,adults:s,max_child:i,paged:u},window.localStorage.setItem("wphb_filter_rooms",JSON.stringify(t)),c(e,t,h)}))},s=(e,t,o)=>{const r=document.querySelectorAll(".wp-hotel-booking-search-rooms .rooms-pagination .page-numbers");r.length>0&&r.forEach((n=>n.addEventListener("click",(a=>{a.preventDefault(),a.stopPropagation(),o.style.display="none",t.style.display="block";let l=JSON.parse(window.localStorage.getItem("wphb_filter_rooms"))||{};if(a.currentTarget.getAttribute("href")){const t=[...r].filter((e=>e.classList.contains("current"))),o=parseInt(a.currentTarget.textContent)||n.classList.contains("next")&&parseInt(t[0].textContent)+1||n.classList.contains("prev")&&parseInt(t[0].textContent)-1;l.paged=o,c(e,{...l})}}))))},i=e=>{const t=document.querySelectorAll(".wp-hotel-booking-search-rooms form.hb-page-search-room-results");if(0==t.length)return;const o=e.querySelector('input[name="check_in_date"]')?.value,r=e.querySelector('input[name="check_out_date"]')?.value;t.forEach((function(e){e.addEventListener("submit",(function(t){t.preventDefault();const n=e.querySelector('select[name="hb-num-of-rooms"]')?.value,a=e.querySelector('input[name="room-id"]')?.value,c=e.querySelector('select[name="hb-num-of-rooms"]')?.value;if(0==c)return void alert("Please select quantity room!");if(""===o||""===r)return void alert(" Please select check in and check out date and search again! ");const l=e.querySelector("button.hb_add_to_cart");l&&l.classList.add("wphb_loading"),async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;const c=[],l=e.querySelectorAll("input.hb_optional_quantity_selected");l&&l.forEach((e=>{if(e.checked){const t=e.dataset.id,o=parseInt(e.parentElement?.nextElementSibling?.querySelector('input[class="hb_optional_quantity"]')?.value)||1;t&&c.push({extraID:t,qty:o})}}));try{const e=await wp.apiFetch({path:"wphb/v1/rooms/book-rooms",method:"POST",data:{roomID:a,checkinDate:o,checkoutDate:r,numRoom:n,extraData:c}}),{status:l,data:s}=e,i=s?.results?.redirect||"";s?.results?.message,t&&t.classList.remove("wphb_loading"),"success"===l&&i&&(window.location.href=i)}catch(e){alert(e.message&&e.message)}}(e,l,n,a)}))}))},u=()=>{const e=document.querySelector(".hb-page-search-room-results select.number_room_select");null!=e&&e.addEventListener("change",(function(t){t.preventDefault();const o=document.querySelectorAll(".hb-page-search-room-results .hb_optional_quantity");null!=o&&o.forEach((function(t){t.value=e.value}))}))},h=e=>{const t=hotel_settings.currency_symbol||"",o=hotel_settings.currency_position||"left";switch(e=m(e),o){case"left":e=t+e;break;case"right":e+=t;break;case"left_with_space":e=t+" "+e;break;case"right_with_space":e=e+" "+t}return e},m=e=>{const t=hotel_settings.number_decimal||0,o=hotel_settings.thousands_separator||"";return(e=(e/1).toFixed(t)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,o)};document.addEventListener("DOMContentLoaded",(()=>{a(),(()=>{const e=document.querySelector("form.hb-select-extra-results");null!==e&&e.addEventListener("submit",(function(t){t.preventDefault();const o=e.querySelector('button[type="submit"]');o&&o.classList.add("wphb_loading"),(async()=>{const t=[],o=e.querySelector('input[name="cart_id"]').value,r=e.querySelectorAll("input.hb_optional_quantity_selected");r&&r.forEach((e=>{if(e.checked){const o=e?.dataset.id||null,r=parseInt(e.parentElement?.nextElementSibling?.querySelector('input[class="hb_optional_quantity"]')?.value)||1;o&&t.push({extraID:o,qty:r})}}));try{const e=await wp.apiFetch({path:"wphb/v1/rooms/add-extra-cart",method:"POST",data:{cartID:o,extraData:t}}),{status:r,redirect:n}=e;console.log(e),"success"===r&&n&&(window.location.href=n)}catch(e){alert(e.message&&e.message)}})()}))})(),(()=>{if(hotel_settings?.is_page_search){const e=document.querySelector(".thim-widget-search-room");if(null!=e){const t=e.querySelector("form#hb-form-search-page");null!=t&&t.removeAttribute("id");const o=e.querySelector("#hotel-booking-results");null!=o&&o.remove()}}const t=document.querySelectorAll('form[class^="hb-search-form"]:not(#hb-form-search-page)');t.length>0&&t.forEach((t=>{t.addEventListener("submit",(function(o){o.preventDefault();const r=t.querySelector('input[name="check_in_date"]').value,a=t.querySelector('input[name="check_out_date"]').value,c=t.querySelector('select[name="adults_capacity"]')?t.querySelector('select[name="adults_capacity"]').value:0,l=t.querySelector('select[name="max_child"]')?t.querySelector('select[name="max_child"]').value:0,s=t.querySelector('input[name="paged"]')?t.querySelector('input[name="paged"]').value:1;if(""===r||""===a)return void alert(" Please select check in and check out date and search again! ");const i={check_in_date:r,check_out_date:a,adults:c,max_child:l,paged:s};window.localStorage.setItem("wphb_filter_rooms",JSON.stringify(i));const u=n(document.location,i).search;window.location.href=e+u}))}))})(),(()=>{const e=document.getElementById("hb-cart-form");if(null===e)return;const t=e.querySelector("a.hb_checkout");null!==t&&t.addEventListener("click",(function(e){e.preventDefault(),hotel_settings?.checkout_page_url?window.location.href=hotel_settings.checkout_page_url:alert("Please set checkout page url in settings")}))})(),r&&hotel_settings&&hotel_settings.is_page_search&&((()=>{const e=document.querySelectorAll(".hb-price-field");if(e)for(let o=0;o<e.length;o++){const r=e[o],n=r.getAttribute("data-min"),c=r.getAttribute("data-max");let l=r.getAttribute("data-step");if(""===n||""===c||""===l)continue;const s=r.querySelector(".hb-min-price"),i=r.querySelector(".hb-max-price"),u=r.querySelector(".hb-price-range"),m=t.min_price||n,p=t.max_price||c;l=parseInt(l),noUiSlider.create(u,{start:[parseInt(m),parseInt(p)],connect:!0,step:l,tooltips:!1,range:{min:parseInt(n),max:parseInt(c)}}),u.noUiSlider.on("update",(function(e,t,o){s.value=parseInt(e[0]),i.value=parseInt(e[1]),r.querySelector(".min").innerHTML=h(e[0]),r.querySelector(".max").innerHTML=h(e[1])})),r.querySelector("button.apply").addEventListener("click",(function(e){e.preventDefault();const o=s.value,r=i.value;t={...t,min_price:parseInt(o),max_price:parseInt(r)},window.localStorage.setItem("wphb_filter_rooms",JSON.stringify(t)),a()}))}})(),(()=>{const e=document.querySelectorAll(".hb-rating-field");if(e)for(let o=0;o<e.length;o++){const r=e[o],n=r.querySelectorAll('input[type="checkbox"]');[...t.rating||[]].map((e=>{r.querySelector(`input[name ="rating"][value ="${e}"]`).checked=!0}));for(let e=0;e<n.length;e++)n[e].addEventListener("change",(function(e){const o=r.querySelectorAll('input[type="checkbox"]:checked');let n=[];[...o].map((e=>{n.push(e.value)})),t={...t,rating:n},window.localStorage.setItem("wphb_filter_rooms",JSON.stringify(t)),a()}))}})(),(()=>{const e=document.querySelectorAll(".hb-type-field");if(e)for(let o=0;o<e.length;o++){const r=e[o],n=r.querySelectorAll('input[type="checkbox"]');[...t.room_type||[]].map((e=>{r.querySelector(`input[name ="room_type"][value ="${e}"]`).checked=!0}));for(let e=0;e<n.length;e++)n[e].addEventListener("change",(function(e){const o=r.querySelectorAll('input[type="checkbox"]:checked');let n=[];[...o].map((e=>{n.push(e.value)})),t={...t,room_type:n},window.localStorage.setItem("wphb_filter_rooms",JSON.stringify(t)),a()}))}})(),(()=>{const e=document.querySelectorAll(".search-filter-form");if(e)for(let o=0;o<e.length;o++){const r=e[o];r.querySelector(".clear-filter button").addEventListener("click",(function(e){const o=document.querySelector(".hb-price-field");if(o){const e=o.getAttribute("data-min"),t=o.getAttribute("data-max");o.querySelector(".hb-price-range").noUiSlider.updateOptions({start:[parseInt(e),parseInt(t)]})}[...r.querySelectorAll(".hb-rating-field input")].map((e=>{e.checked=!1})),[...r.querySelectorAll(".hb-type-field input")].map((e=>{e.checked=!1})),t.hasOwnProperty("min_price")&&delete t.min_price,t.hasOwnProperty("max_price")&&delete t.max_price,t.hasOwnProperty("rating")&&delete t.rating,t.hasOwnProperty("room_type")&&delete t.room_type,window.localStorage.setItem("wphb_filter_rooms",JSON.stringify(t)),a()}))}})(),(()=>{const e=document.querySelector(".sort-by-wrapper");if(!e)return;const o=t.sort_by||"",r=e.querySelectorAll("ul li"),n=e.querySelector(".toggle");[...r].map((e=>{e.getAttribute("data-value")===o?(n.innerHTML=e.innerHTML,e.classList.add("active")):e.classList.remove("active"),e.addEventListener("click",(function(o){const r=e.getAttribute("data-value");t={...t,sort_by:r},window.localStorage.setItem("wphb_filter_rooms",JSON.stringify(t)),a()}))}))})())}))})();